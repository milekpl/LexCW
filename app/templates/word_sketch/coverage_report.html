{#
    Word Sketch Coverage Report Panel

    Include this in workset views to show coverage statistics.
    Required context variables:
    - workset_id: ID of the workset
    - workset_name: Name of the workset (optional)
#}

<div class="card word-sketch-coverage-card" id="word-sketch-coverage-panel" data-workset-id="{{ workset_id }}">
    <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
        <h5 class="mb-0">
            <i class="bi bi-bar-chart-line"></i> Corpus Coverage
        </h5>
        <div class="btn-group btn-group-sm">
            <button type="button" class="btn btn-light" id="btn-refresh-coverage" title="Refresh coverage data">
                <i class="bi bi-arrow-clockwise"></i>
            </button>
            <button type="button" class="btn btn-light" id="btn-view-details" title="View detailed report">
                <i class="bi bi-list-ul"></i>
            </button>
        </div>
    </div>
    <div class="card-body">
        {# Loading state #}
        <div id="coverage-loading" class="text-center py-3" style="display: none;">
            <div class="spinner-border spinner-border-sm text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <small class="text-muted ms-2">Analyzing coverage...</small>
        </div>

        {# Coverage summary #}
        <div id="coverage-summary">
            <div class="text-center py-4 text-muted">
                <i class="bi bi-graph-up fs-1"></i>
                <p class="mt-2">Click "Analyze Coverage" to generate a report</p>
                <button type="button" class="btn btn-primary btn-sm" id="btn-analyze-coverage">
                    <i class="bi bi-play-circle"></i> Analyze Coverage
                </button>
            </div>
        </div>

        {# Detailed report (hidden by default) #}
        <div id="coverage-details" class="mt-3" style="display: none;">
            <ul class="nav nav-tabs" role="tablist">
                <li class="nav-item">
                    <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-missing" type="button">
                        Missing Coverage
                        <span class="badge bg-danger ms-1" id="badge-missing-count">0</span>
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-needs-enrichment" type="button">
                        Need Enrichment
                        <span class="badge bg-warning ms-1" id="badge-enrichment-count">0</span>
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-priority" type="button">
                        Priority Items
                        <span class="badge bg-primary ms-1" id="badge-priority-count">0</span>
                    </button>
                </li>
            </ul>
            <div class="tab-content mt-3">
                <div class="tab-pane fade show active" id="tab-missing" role="tabpanel">
                    <div class="missing-list">
                        <div class="text-muted text-center py-3">Loading...</div>
                    </div>
                </div>
                <div class="tab-pane fade" id="tab-needs-enrichment" role="tabpanel">
                    <div class="enrichment-list">
                        <div class="text-muted text-center py-3">Loading...</div>
                    </div>
                </div>
                <div class="tab-pane fade" id="tab-priority" role="tabpanel">
                    <div class="priority-list">
                        <div class="text-muted text-center py-3">Loading...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card-footer text-muted small">
        <i class="bi bi-info-circle"></i>
        Coverage analysis uses word sketch data from corpus to identify entries
        that need enrichment or are missing from the corpus.
    </div>
</div>

<style>
.word-sketch-coverage-card .coverage-score {
    background: var(--bs-info);
}
.word-sketch-coverage-card .coverage-score.bg-success {
    background: var(--bs-success) !important;
}
.word-sketch-coverage-card .coverage-score.bg-warning {
    background: var(--bs-warning) !important;
    color: #000 !important;
}
.word-sketch-coverage-card .coverage-score.bg-danger {
    background: var(--bs-danger) !important;
}
</style>
