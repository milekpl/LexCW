{% extends "base.html" %}

{% block title %}Search Dictionary{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <h2><i class="fas fa-search"></i> Advanced Search</h2>
        <p class="lead">Find entries, senses, and examples in the dictionary database.</p>
    </div>
</div>

<div class="row">
    <div class="col-md-4">
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5><i class="fas fa-filter"></i> Search Filters</h5>
            </div>
            <div class="card-body">
                <form id="search-form">
                    <div class="mb-3">
                        <label for="search-query" class="form-label">Search Query</label>
                        <input type="text" class="form-control" id="search-query" name="q" 
                               value="{{ request.args.get('q', '') }}" placeholder="Enter search terms...">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Search In</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="lexical_unit" 
                                   id="check-lexical-unit" name="fields[]" checked>
                            <label class="form-check-label" for="check-lexical-unit">
                                Headwords
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="citation_form" 
                                   id="check-citation" name="fields[]" checked>
                            <label class="form-check-label" for="check-citation">
                                Citation Forms
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="definition" 
                                   id="check-definition" name="fields[]" checked>
                            <label class="form-check-label" for="check-definition">
                                Definitions
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="example" 
                                   id="check-example" name="fields[]">
                            <label class="form-check-label" for="check-example">
                                Examples
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="note" 
                                   id="check-note" name="fields[]">
                            <label class="form-check-label" for="check-note">
                                Notes
                            </label>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="pos-filter" class="form-label">Part of Speech</label>
                        <select class="form-select" id="pos-filter" name="pos">
                            <option value="">Any</option>
                            <option value="noun">Noun</option>
                            <option value="verb">Verb</option>
                            <option value="adjective">Adjective</option>
                            <option value="adverb">Adverb</option>
                            <option value="pronoun">Pronoun</option>
                            <option value="preposition">Preposition</option>
                            <option value="conjunction">Conjunction</option>
                            <option value="interjection">Interjection</option>
                            <option value="article">Article</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Search Options</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="1" 
                                   id="check-exact-match" name="exact_match">
                            <label class="form-check-label" for="check-exact-match">
                                Exact Match
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="1" 
                                   id="check-case-sensitive" name="case_sensitive">
                            <label class="form-check-label" for="check-case-sensitive">
                                Case Sensitive
                            </label>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-search"></i> Search
                    </button>
                </form>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header bg-secondary text-white">
                <h5><i class="fas fa-history"></i> Recent Searches</h5>
            </div>
            <div class="card-body p-0">
                <ul class="list-group list-group-flush" id="recent-searches">
                    <!-- Will be populated by JavaScript -->
                </ul>
            </div>
        </div>
    </div>
    
    <div class="col-md-8">
        <div class="card">
            <div class="card-header bg-light">
                <div class="row">
                    <div class="col">
                        <h5 id="search-results-header">Search Results</h5>
                    </div>
                    <div class="col-auto">
                        <div class="btn-group">
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="btn-view-all">
                                <i class="fas fa-list"></i> All
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="btn-view-entries">
                                <i class="fas fa-book"></i> Entries
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="btn-view-senses">
                                <i class="fas fa-lightbulb"></i> Senses
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="btn-view-examples">
                                <i class="fas fa-quote-left"></i> Examples
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div id="search-results-container">
                    <div id="search-initial" class="text-center py-5">
                        <i class="fas fa-search fa-4x text-muted mb-3"></i>
                        <p class="lead">Enter search terms to find entries in the dictionary</p>
                    </div>
                    
                    <div id="search-loading" class="text-center py-5" style="display: none;">
                        <div class="spinner-border text-primary mb-3" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="lead">Searching dictionary...</p>
                    </div>
                    
                    <div id="search-no-results" class="text-center py-5" style="display: none;">
                        <i class="fas fa-exclamation-circle fa-4x text-warning mb-3"></i>
                        <p class="lead">No results found for your search</p>
                        <p>Try adjusting your search terms or filters</p>
                    </div>
                    
                    <div id="search-results" style="display: none;">
                        <!-- Results will be loaded here by JavaScript -->
                    </div>
                </div>
            </div>
            <div class="card-footer" id="results-pagination" style="display: none;">
                <div class="row">
                    <div class="col-md-6">
                        <span id="results-count">0 results</span>
                    </div>
                    <div class="col-md-6">
                        <nav aria-label="Search results pagination" class="float-end">
                            <ul class="pagination pagination-sm mb-0" id="search-pagination">
                                <!-- Pagination will be loaded by JavaScript -->
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Templates for JavaScript -->
<template id="entry-result-template">
    <div class="search-result entry-result mb-4">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="mb-0">
                <a href="#" class="result-entry-link"></a>
                <span class="badge bg-secondary ms-2 result-pos"></span>
            </h5>
            <small class="text-muted result-entry-id"></small>
        </div>
        <div class="result-entry-citation small text-muted mb-2"></div>
        <div class="result-senses"></div>
        <div class="mt-2">
            <a href="#" class="btn btn-sm btn-outline-primary result-edit-link">
                <i class="fas fa-edit"></i> Edit
            </a>
            <a href="#" class="btn btn-sm btn-outline-info result-view-link">
                <i class="fas fa-eye"></i> View
            </a>
        </div>
    </div>
</template>

<template id="sense-result-template">
    <div class="sense-item ps-3 border-start border-2 mb-2">
        <div class="text-muted small">Sense <span class="sense-number"></span></div>
        <div class="sense-definition"></div>
        <div class="sense-examples small fst-italic"></div>
    </div>
</template>

<template id="example-result-template">
    <div class="example-item">
        <i class="fas fa-quote-left text-muted me-1 small"></i>
        <span class="example-text"></span>
        <i class="fas fa-quote-right text-muted ms-1 small"></i>
    </div>
</template>

<template id="recent-search-template">
    <li class="list-group-item d-flex justify-content-between align-items-center">
        <a href="#" class="recent-search-link text-decoration-none"></a>
        <button type="button" class="btn btn-sm btn-outline-secondary recent-search-remove" title="Remove">
            <i class="fas fa-times"></i>
        </button>
    </li>
</template>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/search.js') }}"></script>
{% endblock %}
