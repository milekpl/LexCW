#!/usr/bin/env bash
#
# BaseX Stop Script
#
set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
BASEX_DIR="$(dirname "$SCRIPT_DIR")"
JAR_FILE="$BASEX_DIR/BaseX.jar"
PID_FILE="$BASEX_DIR/.pid"

if [ -f "$JAR_FILE" ]; then
    java -cp "$JAR_FILE" org.basex.BaseXServer -s 2>/dev/null || true
fi

if [ -f "$PID_FILE" ]; then
    pid=$(cat "$PID_FILE")
    if kill -0 "$pid" 2>/dev/null; then
        kill "$pid" 2>/dev/null || true
        sleep 2
        kill -9 "$pid" 2>/dev/null || true
    fi
    rm -f "$PID_FILE"
fi

echo "BaseX stop command sent"
